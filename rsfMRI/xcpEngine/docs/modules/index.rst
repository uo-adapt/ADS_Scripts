.. _modules:

Modules
=========

Pipeline *modules* are self-contained image processing routines. An image processing pipeline is
created by combining desired modules; modules are the building blocks of an image processing
pipeline. Each module either (a) processes the main brain image (the *analyte*), for instance by
filtering or denoising it, or (b) uses the analyte to produce another dataset, called a
*derivative*. (It’s also possible for modules to use derivatives to produce further derivatives).


Functional image processing
---------------------------

Modules that process the analyte for functional data.

 * :ref:`prestats`: Formerly an omnibus module for functional
   preprocessing. Its functionality is largely implemented in ``FMRIPREP`` and additional
   functions have been moved to other modules.
 * :ref:`confound2`: Generates a matrix of nuisance time series for confound regression. Supports
   most frequently used denoising models, including realignment parameters, tissue-based time
   series, PCA-derived time series, the global signal, and temporal expansions.
 * :ref:`regress`: Executes confound regression using the matrix
   generated by the :ref:`confound` module. Censors any volumes flagged for poor data quality.
   Incorporates spatial and temporal filtering.

Functional derivatives
--------------------------

Modules that generate derivative maps from functional data.
 * :ref:`task`: performs FSL FEAT processing 
 * :ref:`reho`: Computes voxelwise regional homogeneity.
 * :ref:`alff`: Computes the amplitude of low-frequency fluctuations voxelwise.
 * :ref:`seed`: Computes functional connectivity to an *a priori* set of seed regions using
   seed-based correlation analysis.

Anatomical image processing
----------------------------

Modules that process the analyte for anatomical data. Note that anatomical imaging processing using the `struct` module is *NOT* required unless desired, anatomic processing completed as part of fMRIPREP can be used instead.

 * :ref:`struc`: Omnibus module for volumetric anatomical preprocessing. Leverages ANTs to execute
   N4 bias field correction, SyN diffeomorphic registration, Atropos segmentation (prior-driven or
   priorless), or the complete ANTs Cortical Thickness pipeline.

Anatomical derivatives
-----------------------

Modules that generate derivative maps from anatomical data.

 * ``jlf``: *UNSUPPORTED* Uses the ANTs Joint Label Fusion algorithm to produce a
   high-resolution anatomical segmentation of the subject’s anatomical data. Generates a
   subject-specific atlas of anatomical landmarks that can be used for regional quantification or
   network mapping.
 * :ref:`gmd`: Computes voxelwise grey matter density.


Registration
-------------

Modules that generate transforms between different coordinate spaces, or that apply those transforms.

 * :ref:`struc`: Computes transforms between a high-resolution anatomical image and a template
   image representing a standard coordinate space using the top-performing SyN algorithm.
 * :ref:`norm`: Applies the requisite transforms (computed by ``struc``) to shift all derivative
   maps from subject native space to a standard coordinate space.

Regional quantification
------------------------

 * :ref:`roiquant`: Uses provided brain atlases or parcellations to compute, for each voxelwise
   derivative, a value for each region of interest in each provided brain atlas or parcellation.
   Converts voxelwise derivatives to regional derivatives.

Connectomics and networks
--------------------------

Modules that map or analyse brain networks.

 * :ref:`fcon`: Computes the functional connectivity between each pair of regions in each provided
   brain atlas or parcellation to produce an adjacency matrix for the functional connectome.
   Computes dynamic FC using the MTD.

Quality assessment
--------------------

Modules that produce estimates of data quality.

 * :ref:`qcfc`: Quality assessment for functional connectivity. Generates voxelwise plots, QC-FC
   measures, and QC-FC estimates of distance-dependence to facilitate diagnosis of motion-related
   contamination and assessment of denoising efficacy.
 

Quick Lookup
--------------

.. toctree::
  :maxdepth: 1

  prestats
  confound
  regress
  reho
  alff
  seed
  task
  struc
  gmd
  norm
  roiquant
  fcon
  qcfc
